<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spine AI Analysis Dashboard</title>
    <link rel="stylesheet" href="styles.css?v=2">
    <!-- Local Fonts and Icons are handled in styles.css or inline SVGs for offline support -->
    <style>
        /* Fallback for missing icon font */
        .icon-fallback {
            font-style: normal;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div class="bento-container">
        <!-- Area: Header -->
        <header class="header-panel glass-panel">
            <div class="logo-area">
                <svg class="logo-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="24" height="24"
                    fill="currentColor">
                    <path
                        d="M460.1 43.1c-19.1 0-36.8 6.7-50 17.5-35.6-28.9-88.4-25.9-123.6 9.3l-5.8 5.8-5.8-5.8C239.7 34.7 186.9 31.7 151.4 60.6c-13.2-10.8-30.8-17.5-50-17.5C45.4 43.1 0 88.5 0 144.5c0 37.5 20.3 70.3 50.8 88.6-4.6 12-7.8 24.6-9.4 37.8-15.6 15.6-25.4 37.1-25.4 61.1 0 23.9 9.8 45.5 25.4 61.1 1.6 13.2 4.8 25.8 9.4 37.8C20.3 449.6 0 482.5 0 520c0 56 45.4 101.4 101.4 101.4 19.1 0 36.8-6.7 50-17.5 35.6 28.9 88.4 25.9 123.6-9.3l5.8-5.8 5.8 5.8c35.1 35.1 87.9 38.1 123.5 9.3 13.2 10.8 30.8 17.5 50 17.5 56 0 101.4-45.4 101.4-101.4 0-37.5-20.3-70.3-50.8-88.6 4.6-12 7.8-24.6 9.4-37.8 15.6-15.6 25.4-37.1 25.4 61.1 0-23.9-9.8-45.5-25.4-61.1-1.6-13.2-4.8-25.8-9.4-37.8C491.7 310.8 512 277.9 512 240.5c0-56-45.4-101.4-101.4-101.4-19.1 0-36.8 6.7-50 17.5-35.6-28.9-88.4-25.9-123.6 9.3l-5.8 5.8-5.8-5.8c-35.1-35.1-87.9-38.1-123.5-9.3-13.2-10.8-30.8-17.5-50-17.5-24 0-46 9.8-61.6 25.4-11.9-4.7-24.5-7.8-37.7-9.4-15.6-15.6-37.1-25.4-61.1-25.4-24 0-45.5 9.8-61.1 25.4 13.2 1.6 25.8 4.7 37.7 9.4 15.6 15.6 37.6 25.4 61.6 25.4 19.1 0 36.8-6.7 50-17.5 35.6 28.9 88.4 25.9 123.6-9.3l5.8-5.8 5.8 5.8c35.1 35.1 87.9 38.1 123.5 9.3 13.2 10.8 30.8 17.5 50 17.5 24 0 46 9.8 61.6 25.4 11.9-4.7-24.5-7.8-37.7-9.4-15.6-15.6-37.1-25.4-61.1-25.4 24 0 45.5 9.8 61.1 25.4-13.2 1.6-25.8 4.7-37.7 9.4-15.6 15.6-37.6 25.4-61.6 25.4z"
                        transform="scale(0.04)" />
                </svg>
                <h1>Spinepose <span class="version-tag">PRO v2.0</span></h1>
            </div>
            <div class="user-greeting" id="greeting-msg">Welcome Back</div>
            <div class="header-controls">
                <div class="status-badge" id="sys-status">
                    <span class="status-dot"></span> System Standby
                </div>
                <div class="time-display timestamp">--:--</div>
            </div>
        </header>

        <!-- Area: Main Feed (Large) -->
        <div class="main-feed-panel glass-panel">
            <div class="panel-header">
                <span class="panel-title">Live Analysis Feed</span>
                <span class="live-indicator">● LIVE</span>
            </div>
            <div class="viewport-large" id="scan-1">
                <div class="overlay-ui">
                    <div class="corner-bracket top-left"></div>
                    <div class="corner-bracket top-right"></div>
                    <div class="corner-bracket bottom-left"></div>
                    <div class="corner-bracket bottom-right"></div>
                    <div class="center-target">+</div>
                </div>
            </div>
        </div>

        <!-- Area: Biometrics (Side) -->
        <div class="metrics-panel glass-panel">
            <div class="panel-header">
                <span class="panel-title">Real-time Biometrics</span>
            </div>
            <div class="metric-grid">
                <div class="metric-item">
                    <span class="lbl">Cobb Angle</span>
                    <div class="val-box">
                        <span class="val" id="val-cobb">0°</span>
                        <div class="mini-chart c-blue" style="width: 30%"></div>
                    </div>
                </div>
                <div class="metric-item">
                    <span class="lbl">Lumbar Flexion</span>
                    <div class="val-box">
                        <span class="val" id="val-lumbar">0°</span>
                        <div class="mini-chart c-purple" style="width: 45%"></div>
                    </div>
                </div>
                <div class="metric-item">
                    <span class="lbl">Cervical Flexion</span>
                    <div class="val-box">
                        <span class="val" id="val-cervical">0°</span>
                        <div class="mini-chart c-cyan" style="width: 20%"></div>
                    </div>
                </div>
            </div>

            <div class="health-score-container">
                <svg class="circle-ring" width="140" height="140">
                    <circle class="c-bg" cx="70" cy="70" r="60"></circle>
                    <circle class="c-val" cx="70" cy="70" r="60"></circle>
                </svg>
                <div class="score-inner">
                    <span class="score-text">--%</span>
                    <span class="score-label">Spine Health</span>
                </div>
            </div>
        </div>

        <!-- Area: Secondary Views (Bottom Grid) -->
        <div class="sub-views-panel">
            <div class="glass-panel sub-view">
                <span class="vp-label">Sagittal View</span>
                <div class="sub-viewport" id="scan-2"></div>
            </div>
            <div class="glass-panel sub-view">
                <span class="vp-label">Coronal View</span>
                <div class="sub-viewport" id="scan-3"></div>
            </div>
            <div class="glass-panel sub-view">
                <span class="vp-label">Biomech Heatmap</span>
                <div class="sub-viewport active-scan" id="scan-4"></div>
            </div>
        </div>

        <!-- Area: Control Dock -->
        <div class="control-dock glass-panel">
            <div class="dock-group">
                <button class="dock-btn active" id="btn-medical" onclick="setMode('medical')" title="Medical Mode">
                    <svg class="dock-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="20"
                        height="20" fill="currentColor">
                        <path
                            d="M285.4 17.5c-48.4-27.4-106.7-16-144.5 21.8L28.1 152.1c-37.8 37.8-49.2 96.1-21.8 144.5 24.3 43 78.4 59 123.1 39.4l7.1 7.1c-19.6 44.7-3.6 98.8 39.4 123.1 48.4 27.4 106.7 16 144.5-21.8l112.8-112.8c37.8-37.8 49.2-96.1 21.8-144.5-24.3-43-78.4-59-123.1-39.4l-7.1-7.1c19.6-44.7 3.6-98.8-39.4-123.1zM118.6 152.1c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0l-192-192c-12.5-12.5-12.5-32.8 0-45.3z"
                            transform="scale(0.045) translate(100,100)" />
                    </svg>
                    <span>Medical</span>
                </button>
                <button class="dock-btn" id="btn-sports" onclick="setMode('sports')" title="Sports Mode">
                    <svg class="dock-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="20"
                        height="20" fill="currentColor">
                        <path
                            d="M365.1 364L259.5 210.8l20.4-38.8c4.6-8.7 15.6-13.6 24.6-9l13.6 6.9c25.9 13.2 57.5-4.4 61-33.2l5.7-47.5c2.4-19.7-11.4-37.5-31-40L309 45.5c-30.8-3.9-60.5 12.9-74.1 40.5L209.6 137l-60-29.2c-15-7.3-33-3-42.9 10.4L20 236.4c-13.8 18.7-9.9 44.9 8.8 58.7l3.4 2.5c18.7 13.8 44.9 9.9 58.7-8.8l58.1-78.6 30 14.6-28.8 62.4c-11.8 25.6-4.9 55.7 17.5 73.6l106 84.8c18.2 14.6 44.7 12.1 59.8-5.3l37.8-43.2c16-18.3 12.9-46.2-5.9-60.4zM160 96a48 48 0 1 1 48-48 48 48 0 0 1-48 48z"
                            transform="scale(0.045) translate(50,50)" />
                    </svg>
                    <span>Sports</span>
                </button>
            </div>

            <div class="dock-separator"></div>

            <button class="main-action-btn" id="main-ctl" onclick="toggleStream()">
                Start Analysis
            </button>

            <div class="dock-separator"></div>

            <div class="dock-group icon-only">
                <!-- Upload, Camera, Screenshot buttons with SVGs -->
                <input type="file" id="file-upload" accept="image/*,video/*" style="display:none"
                    onchange="uploadFile(this)">
                <button class="dock-icon-btn" onclick="document.getElementById('file-upload').click()" title="Upload">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" width="18" height="18"
                        fill="currentColor">
                        <path
                            d="M572.6 270.3l-96 192C471.2 473.2 460.1 480 447.9 480H64c-35.3 0-64-28.7-64-64V96c0-35.3 28.7-64 64-64h117.5c17 0 33.3 6.7 45.3 18.7l26.5 26.5c12 12 28.3 18.7 45.3 18.7H416c35.3 0 64 28.7 64 64v38.6c0 13.9 11.2 25.2 25.2 25.2h12.5c22.3 0 37.9 21.6 29.6 42.1zM448 160H298.6c-8.5 0-16.6-3.4-22.6-9.4L249.4 124c-17-17-40.1-26.5-64.1-26.5H64v320h384L544 224v-64H448z" />
                    </svg>
                </button>
                <button class="dock-icon-btn" onclick="toggleCameraVisibility()" title="Camera">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" width="18" height="18"
                        fill="currentColor">
                        <path
                            d="M0 128C0 92.7 28.7 64 64 64H320c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128zM559.1 99.8c10.4 5.6 16.9 16.4 16.9 28.2V384c0 11.8-6.5 22.6-16.9 28.2s-23 5-32.9-1.6l-96-64L448 374.9V137.1L430.2 165.4l96-64c9.8-6.5 22.4-7.2 32.9-1.6z" />
                    </svg>
                </button>
                <button class="dock-icon-btn" onclick="takeScreenshot()" title="Save">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="18" height="18"
                        fill="currentColor">
                        <path
                            d="M149.1 64.8L138.7 96H64C28.7 96 0 124.7 0 160V416c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V160c0-35.3-28.7-64-64-64H373.3L362.9 64.8C356.4 45.2 338.1 32 317.4 32H194.6c-20.7 0-39 13.2-45.5 32.8zM256 192a96 96 0 1 1 0 192 96 96 0 1 1 0-192z" />
                    </svg>
                </button>
                <div style="width:10px"></div>
                <button class="dock-btn record-btn" id="btn-record" onclick="toggleRecord()">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="10" height="10"
                        fill="currentColor" style="margin-right:5px;">
                        <path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512z" />
                    </svg> REC
                </button>
            </div>

            <div class="dock-separator"></div>

            <select id="patient-selector" onchange="setPatient(this.value)" class="glass-select">
                <option value="">Select Patient...</option>
                <option value="new">+ New Patient</option>
            </select>
        </div>

        <!-- Area: Patient/Report (Floating) -->
        <div class="patient-panel glass-panel">
            <div class="p-info">
                <div class="p-row"><span>PATIENT:</span> <strong id="p-name">Guest User</strong></div>
                <div class="p-row"><span>ID:</span> <strong id="p-id">---</strong></div>
            </div>
            <button class="export-btn" onclick="generateReport()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="14" height="14" fill="currentColor"
                    style="margin-right:5px;">
                    <path
                        d="M0 64C0 28.7 28.7 0 64 0H224V128c0 17.7 14.3 32 32 32H384V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V64zm384 64H256V0L384 128z"
                        transform="scale(0.045) translate(50,50)" />
                </svg> Report
            </button>
        </div>

    </div>

    <!-- Hidden audio for alerts if needed -->
    <script src="script.js"></script>
</body>

</html>